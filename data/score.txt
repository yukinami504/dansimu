スコア計算が合わない！！！！！


スコアアップなしでもそういう状況である（けっこう下振れする）

検証していく

検証：フォールオブフォールHard~Lunatic

とあるパーティで戦力は71682

Hard
(0.334*17+10.807)*71682/496=2382.41485887

Lunatic
(0.334*25+10.807)*71682/765=1544.67682353

大事な点が一つあり、それぞれ素点は2382,1544点となるが、
50コンボ目まで綺麗に加算されていたが、51コンボ目以降(コンボボーナスが付き始める~)

50:119100 (50*2382)
51:121506 (+2406)
52:123912
53:126318
54:128724
55:131130
56:
57:
58:138348
60:
99:236994
100:239376

127:304986
129:309846(+2430)
200:482328
291:705642
299:725274(+2454)
301:730134
311:754914(+2478)
391:953154
397:968022
399:972978
401:977861(+2501)
496:1215456

これを見る限り、同じコンボボーナス帯で加算される点数は変わらない
ただ、それらを出すには小数計算を丸めている
仮定 : 基礎点（小数）*ボーナスを四捨五入？五捨六入？

2382.41485887*1.01 = 2406.23900746
2382.41485887*1.02 = 2430.06315605
2382.41485887*1.03 = 2453.88730464
2382.41485887*1.04 = 2477.71145322
2382.41485887*1.05 = 2501.53560181



2382*1.01 = 2405.82
2382*1.02 = 2429.64
2382*1.03 = 2453.46
2382*1.04 = 2477.28
2382*1.05 = 2501.1

1.03倍で若干、1.04倍の時が明らかに足りていない
そのくせ、1.05倍の時はそうでもない
仮に四捨五入で、1.05倍が2501になる場合の素点が2382.38*1.05=2501.499
2382.38*1.04=2477.6752なのでOK
逆の場合、2382.22*1.04=2477.5088,  2382.22*1.05=2501.331という感じ

つまり四捨五入条件だと、素点が2382.22-2382.38の間と推定される

逆に切り捨て条件だと、素点2382.70-2382.85

71682*(0.334*17+10.806)/496=2382.27033871
+10.807だとちょっと合わなかった...



四捨五入条件として、他の曲（難易度）でも試してみる


同条件で試したかったが、開花レベルボーナスが上がってしまった（失態）


今更だが一の位だけ見れば良いことが分かった
戦力70951
(0.334*25+10.806)*70951/765 = 1776.65013856
(0.334*25+10.807)*70951/765 = 1776.74288497

50:88850
51:

99:180380
100:182157

172:312621
186:334365
206:370678
212:381658
337:611021
339:614717
444:809434
448:816894
461:841139
554:1015468
563:1032415
573:1051245
609:1119089
642:1181822
723:1336093
735:1359121
765:1416691


1-50    :1777
51-99   :1794
101-199 :1812
201-299 :1830
301-399 :1848
401-499 :1865
501-599 :1883
601-699 :1901
701-    :1919

1777*1.01 = 1794.77
1777*1.02 = 1812.54
1777*1.03 = 1830.31
1777*1.04 = 1848.08
1777*1.05 = 1865.85
1777*1.06 = 1983.62
1777*1.07 = 1901.39
1777*1.08 = 1919.16

仮に四捨五入条件の場合
素点1776.5-1776.66
切り捨て条件の場合
1777-1777.14
やっぱり、四捨五入条件の+10.806が濃厚そう



計1417185


定数、+10.8057より小さい説
定数なのか、どこかで切り捨て処理をしているのか

スコアアップを加えた状態でもけっこう-1があるので、切り捨てになっている可能性はある


03/01更新
式が加筆されていたので反映（ありがとうございます）
係数が0.3342、定数が10.8058だそうな
それでコンボボーナス後切り捨て、スキル効果後に再度切り捨てだそうな
なるほどね。

ちなみに62%カグラエフェクトを+5%ヒロインと属性一致を併用して使用したところ、点数がぶれたので
属性一致で1.5倍した後に+5%してるっぽい。



